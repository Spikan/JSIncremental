<!doctype html>

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Soda Clicker Pro</title>
    <meta name="description" content="Soda Clicker Pro" />
    <meta name="author" content="Spikan" />
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <link rel="icon" type="image/png" href="images/regSoda.png" />

    <!-- Ensure Decimal/Zod are available before any modules execute (prod places module in head) -->
    <script src="https://cdn.jsdelivr.net/npm/break_eternity.js@2.1.2/dist/break_eternity.min.js"></script>
    <script src="https://unpkg.com/zod@3.22.4/lib/index.umd.js"></script>
    <script>
      // Diagnostics + start shims for production
      (function () {
        try {
          window.__diag = Array.isArray(window.__diag) ? window.__diag : [];
          window.addEventListener('error', function (e) {
            try {
              window.__diag.push({ type: 'error', msg: e.message, src: e.filename, ln: e.lineno });
            } catch {}
          });
          window.addEventListener('unhandledrejection', function (e) {
            try {
              var r = e && e.reason;
              window.__diag.push({
                type: 'unhandledrejection',
                reason: (r && (r.message || r)) + '',
              });
            } catch {}
          });
        } catch {}
      })();

      // Safety check to ensure functions are available - moved to after main.js loads
      window.addEventListener('load', function () {
        // Wait for modules to load and APIs to be available
        function checkFunctionsLoaded() {
          var hasSwitchTab = !!(
            window.App &&
            window.App.ui &&
            typeof window.App.ui.switchTab === 'function'
          );
          if (!hasSwitchTab) {
            console.log('‚è≥ Waiting for App.ui.switchTab...');
            setTimeout(checkFunctionsLoaded, 200);
            return;
          }
          console.log('‚úÖ App.ui.switchTab is available');
        }

        // Start checking after a brief initial delay
        setTimeout(checkFunctionsLoaded, 1000);

        // HTML-level splash fallback: ensure any interaction starts the game
        try {
          var manualStart = function () {
            try {
              var splash = document.getElementById('splashScreen');
              var game = document.getElementById('gameContent');
              if (splash && game) {
                try {
                  document.body &&
                    document.body.classList &&
                    document.body.classList.add('game-started');
                } catch {}
                try {
                  splash.style.display = 'none';
                  splash.style.visibility = 'hidden';
                  splash.style.pointerEvents = 'none';
                  if (splash.parentNode) splash.parentNode.removeChild(splash);
                } catch {}
                try {
                  game.style.display = 'block';
                  game.style.visibility = 'visible';
                  game.style.opacity = '1';
                  game.classList && game.classList.add('active');
                } catch {}
                // After showing the game, try to initialize and start loop when available
                try {
                  var startOnce = (function () {
                    var done = false;
                    return function (fn) {
                      if (done) return;
                      done = true;
                      try {
                        fn && fn();
                      } catch {}
                    };
                  })();

                  var pollInitAndLoop = function () {
                    try {
                      // Call initGame if it exists
                      if (typeof window.initGame === 'function') {
                        startOnce(function () {
                          window.initGame();
                        });
                      }

                      // Start main loop with real callbacks when available
                      var loopStart =
                        window.App &&
                        window.App.systems &&
                        window.App.systems.loop &&
                        window.App.systems.loop.start;

                      if (typeof loopStart === 'function') {
                        try {
                          var cfg = (window.GAME_CONFIG && window.GAME_CONFIG.TIMING) || {};
                          var DEFAULT_RATE = Number(cfg.DEFAULT_DRINK_RATE || 5000);
                          var st0 =
                            (window.App &&
                              window.App.state &&
                              window.App.state.getState &&
                              window.App.state.getState()) ||
                            {};
                          var rate0 = Number(st0.drinkRate || window.drinkRate || 0);
                          if (!rate0 || rate0 <= 0) {
                            var now0 = Date.now();
                            window.drinkRate = DEFAULT_RATE;
                            window.lastDrinkTime = now0 - DEFAULT_RATE;
                            window.App &&
                              window.App.state &&
                              window.App.state.setState &&
                              window.App.state.setState({
                                drinkRate: DEFAULT_RATE,
                                lastDrinkTime: window.lastDrinkTime,
                                drinkProgress: 0,
                              });
                            try {
                              window.__diag &&
                                window.__diag.push({ type: 'shim', fix: 'setDefaultDrinkRate' });
                            } catch {}
                          }
                        } catch {}
                        loopStart({
                          updateDrinkProgress: function () {
                            try {
                              var st =
                                (window.App &&
                                  window.App.state &&
                                  window.App.state.getState &&
                                  window.App.state.getState()) ||
                                {};
                              var now = Date.now();
                              var last = Number(
                                (st && st.lastDrinkTime) || window.lastDrinkTime || 0
                              );
                              var rate = Number((st && st.drinkRate) || window.drinkRate || 1000);
                              var pct = Math.min(((now - last) / Math.max(rate, 1)) * 100, 100);
                              window.App &&
                                window.App.state &&
                                window.App.state.setState &&
                                window.App.state.setState({ drinkProgress: pct });
                              window.App &&
                                window.App.ui &&
                                window.App.ui.updateDrinkProgress &&
                                window.App.ui.updateDrinkProgress(pct, rate);
                            } catch {}
                          },
                          processDrink: function () {
                            try {
                              window.App &&
                                window.App.systems &&
                                window.App.systems.drink &&
                                window.App.systems.drink.processDrink &&
                                window.App.systems.drink.processDrink();
                            } catch {}
                          },
                          updateStats: function () {
                            try {
                              window.App &&
                                window.App.ui &&
                                window.App.ui.updatePlayTime &&
                                window.App.ui.updatePlayTime();
                              window.App &&
                                window.App.ui &&
                                window.App.ui.updateLastSaveTime &&
                                window.App.ui.updateLastSaveTime();
                              window.App &&
                                window.App.ui &&
                                window.App.ui.updateAllStats &&
                                window.App.ui.updateAllStats();
                              window.App &&
                                window.App.ui &&
                                window.App.ui.updatePurchasedCounts &&
                                window.App.ui.updatePurchasedCounts();
                              window.App &&
                                window.App.ui &&
                                window.App.ui.checkUpgradeAffordability &&
                                window.App.ui.checkUpgradeAffordability();
                              window.App &&
                                window.App.systems &&
                                window.App.systems.unlocks &&
                                window.App.systems.unlocks.checkAllUnlocks &&
                                window.App.systems.unlocks.checkAllUnlocks();
                            } catch {}
                          },
                          updatePlayTime: function () {
                            try {
                              window.App &&
                                window.App.ui &&
                                window.App.ui.updatePlayTime &&
                                window.App.ui.updatePlayTime();
                            } catch {}
                          },
                          updateLastSaveTime: function () {
                            try {
                              window.App &&
                                window.App.ui &&
                                window.App.ui.updateLastSaveTime &&
                                window.App.ui.updateLastSaveTime();
                            } catch {}
                          },
                        });
                        try {
                          window.__diag && window.__diag.push({ type: 'shim', used: 'loopStart' });
                        } catch {}
                        return; // loop started, stop polling
                      }
                    } catch {}
                    setTimeout(pollInitAndLoop, 100);
                  };
                  pollInitAndLoop();
                } catch {}
              }
              try {
                window.__diag && window.__diag.push({ type: 'shim', used: 'manualStart' });
              } catch {}
            } catch {}
          };

          var startIfPossible = function (e) {
            try {
              var splash = document.getElementById('splashScreen');
              if (splash && splash.style.display !== 'none') {
                e && e.preventDefault && e.preventDefault();
                e && e.stopPropagation && e.stopPropagation();
                if (typeof window.startGame === 'function') {
                  window.startGame();
                  try {
                    window.__diag && window.__diag.push({ type: 'shim', call: 'startGame' });
                  } catch {}
                } else if (
                  window.App &&
                  window.App.systems &&
                  window.App.systems.gameInit &&
                  typeof window.App.systems.gameInit.startGameCore === 'function'
                ) {
                  window.App.systems.gameInit.startGameCore();
                  try {
                    window.__diag && window.__diag.push({ type: 'shim', call: 'startGameCore' });
                  } catch {}
                } else {
                  manualStart();
                }
              }
            } catch (err) {
              console.warn('HTML-level fallback failed:', err);
            }
          };
          document.addEventListener('click', startIfPossible, { capture: true });
          document.addEventListener('pointerdown', startIfPossible, { capture: true });
          document.addEventListener('keydown', function (e) {
            if (e.code === 'Space' || e.code === 'Enter') startIfPossible(e);
          });
          setTimeout(function () {
            var splash = document.getElementById('splashScreen');
            if (splash && splash.style.display !== 'none') {
              startIfPossible({ preventDefault: function () {}, stopPropagation: function () {} });
            }
          }, 3000);
        } catch (err) {
          console.warn('Failed to attach HTML-level splash fallback:', err);
        }
      });
    </script>
  </head>

  <body>
    <!-- Splash Screen -->
    <div id="splashScreen" class="splash-overlay">
      <div class="splash-content">
        <div class="splash-title">
          <h1 class="splash-main-title">SODA CLICKER</h1>
          <h2 class="splash-subtitle">PRO</h2>
        </div>
        <div class="splash-subtitle-text">
          <p>THE ULTIMATE SODA DRINKING EXPERIENCE</p>
        </div>
        <div class="splash-instruction">
          <p>CLICK TO START</p>
        </div>
        <div class="splash-warning">
          ‚ö†Ô∏è This game is under active development. Things WILL stop working randomly.
        </div>
        <div class="splash-buttons">
          <button class="splash-start-btn" data-action="startGame">START</button>
        </div>
        <div class="splash-version">
          <p>v1.0 - Inspired by Soda Drinker Pro</p>
        </div>
      </div>
    </div>

    <!-- Main Game Content -->
    <div id="gameContent" class="game-content mobile-content-padding" style="display: none">
      <!-- Consolidated Game Header -->
      <div class="game-header">
        <div class="level-indicator">
          <div class="level-number">Level <span id="levelNumber">1</span></div>
          <div class="level-text" id="levelText">On a Blue Background</div>
        </div>

        <div class="header-main-content">
          <div class="currency-display">
            <div class="currency-item primary">
              <div class="currency-icon">üíß</div>
              <div class="currency-info">
                <div class="currency-label">Total Sips</div>
                <div class="currency-value" id="topSipValue">0</div>
              </div>
            </div>
            <div class="currency-divider"></div>
            <div class="currency-item">
              <div class="currency-info">
                <div class="currency-label">Per Drink</div>
                <div class="currency-value" id="topSipsPerDrink">1</div>
              </div>
            </div>
            <div class="currency-divider"></div>
            <div class="currency-item">
              <div class="currency-info">
                <div class="currency-label">Per Second</div>
                <div class="currency-value" id="topSipsPerSecond">1</div>
              </div>
            </div>
          </div>

          <!-- Drink Progress Bar in Header -->
          <div class="header-drink-progress">
            <div class="drink-progress-info">
              <span class="drink-label">Next Drink:</span>
              <span class="drink-countdown" id="drinkCountdown">5.0s</span>
            </div>
            <div class="drink-progress-bar">
              <div class="drink-progress-fill" id="drinkProgressFill"></div>
            </div>
          </div>
        </div>

        <div class="game-title">
          <div class="title-main">SODA CLICKER</div>
          <div class="title-sub">PRO</div>
        </div>
      </div>

      <!-- Desktop Tab Navigation -->
      <div class="tab-navigation desktop-only">
        <button class="tab-btn active" data-action="switchTab:soda" aria-label="Soda Clicking Tab">
          <span class="tab-icon">ü•§</span>
          <span class="tab-label">Soda Clicking</span>
        </button>
        <button class="tab-btn" data-action="switchTab:unlocks" aria-label="Unlocks Tab">
          <span class="tab-icon">üîì</span>
          <span class="tab-label">Unlocks</span>
        </button>
        <button class="tab-btn" data-action="switchTab:shop" aria-label="Shop & Upgrades Tab">
          <span class="tab-icon">üõí</span>
          <span class="tab-label">Shop & Upgrades</span>
        </button>
        <button class="tab-btn" data-action="switchTab:stats" aria-label="Statistics Tab">
          <span class="tab-icon">üìä</span>
          <span class="tab-label">Statistics</span>
        </button>
        <button class="tab-btn" data-action="switchTab:god" aria-label="Talk to God Tab">
          <span class="tab-icon">üôè</span>
          <span class="tab-label">Talk to God</span>
        </button>
        <button class="tab-btn" data-action="switchTab:options" aria-label="Options Tab">
          <span class="tab-icon">‚öôÔ∏è</span>
          <span class="tab-label">Options</span>
        </button>
        <button class="tab-btn" data-action="switchTab:dev" aria-label="Dev Tools Tab">
          <span class="tab-icon">üîß</span>
          <span class="tab-label">Dev Tools</span>
        </button>
      </div>

      <!-- Mobile Bottom Navigation -->
      <div class="mobile-tab-navigation mobile-only">
        <div
          class="mobile-tab-item active"
          data-action="switchTab:soda"
          aria-label="Soda Clicking Tab"
          role="button"
          tabindex="0"
        >
          <div class="mobile-tab-icon">ü•§</div>
          <div class="mobile-tab-label">Soda</div>
        </div>
        <div
          class="mobile-tab-item"
          data-action="switchTab:shop"
          aria-label="Shop & Upgrades Tab"
          role="button"
          tabindex="0"
        >
          <div class="mobile-tab-icon">üõí</div>
          <div class="mobile-tab-label">Shop</div>
        </div>
        <div
          class="mobile-tab-item"
          data-action="switchTab:unlocks"
          aria-label="Unlocks Tab"
          role="button"
          tabindex="0"
        >
          <div class="mobile-tab-icon">üîì</div>
          <div class="mobile-tab-label">Unlock</div>
        </div>
        <div
          class="mobile-tab-item"
          data-action="switchTab:stats"
          aria-label="Statistics Tab"
          role="button"
          tabindex="0"
        >
          <div class="mobile-tab-icon">üìä</div>
          <div class="mobile-tab-label">Stats</div>
        </div>
        <div
          class="mobile-tab-item"
          data-action="switchTab:options"
          aria-label="Options Tab"
          role="button"
          tabindex="0"
        >
          <div class="mobile-tab-icon">‚öôÔ∏è</div>
          <div class="mobile-tab-label">More</div>
        </div>
      </div>

      <!-- Drink Speed Upgrade Section - Moved from progress bar area -->
      <div class="drink-speed-upgrade-section">
        <div class="drink-speed-upgrade-container">
          <div class="drink-speed-relationship-indicator">
            <span class="relationship-icon">‚ö°</span>
            <span class="relationship-text">Enhances: Drink Speed</span>
          </div>
          <button class="drink-speed-upgrade-btn" data-action="buyFasterDrinks">
            <div class="drink-speed-upgrade-icon">‚ö°</div>
            <div class="drink-speed-upgrade-info">
              <div class="drink-speed-upgrade-name">Faster Drinks</div>
              <div class="drink-speed-upgrade-cost">
                <span id="fasterDrinksCostCompact">80</span> Sips
              </div>
            </div>
          </button>
          <div class="drink-speed-upgrade-stats">
            <span class="drink-speed-stat"
              >Speed: <span id="currentDrinkSpeedCompact">5.00s</span></span
            >
            <span class="drink-speed-stat">Bonus: <span id="drinkSpeedBonusCompact">0%</span></span>
          </div>
          <button class="drink-speed-upgrade-btn upgrade" data-action="upgradeFasterDrinks">
            <div class="drink-speed-upgrade-icon">üîß</div>
            <div class="drink-speed-upgrade-info">
              <div class="drink-speed-upgrade-name">Upgrade Faster Drinks</div>
              <div class="drink-speed-upgrade-cost">
                <span id="fasterDrinksUpCostCompact">1500</span> Sips
              </div>
            </div>
          </button>
        </div>
      </div>

      <!-- Soda Clicking Tab -->
      <div id="sodaTab" class="tab-content active">
        <div class="game-main">
          <!-- Primary Action Area -->
          <div class="primary-action-area">
            <div class="soda-clicking-section">
              <div class="soda-container">
                <img
                  src="images/regSoda.png"
                  id="sodaButton"
                  data-action="sodaClick"
                  data-args="1"
                  alt="a picture of soda for you to click"
                  class="soda-button"
                />
                <div class="click-indicator" id="clickIndicator">
                  <div class="click-ripple"></div>
                </div>
              </div>

              <div class="soda-info">
                <div class="soda-stats">
                  <div class="stat-item">
                    <span class="stat-label">Click Value</span>
                    <span class="stat-value" id="clickValue">1</span>
                  </div>
                  <div class="stat-item">
                    <span class="stat-label">Critical Chance</span>
                    <span class="stat-value" id="criticalChance">0%</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="level-up-section">
              <div class="level-up-card">
                <div class="level-up-header">
                  <div class="level-up-icon">‚≠ê</div>
                  <div class="level-up-info">
                    <h3 class="level-up-title">Level Up</h3>
                    <p class="level-up-description">+150% sips per drink</p>
                  </div>
                </div>
                <button class="level-up-btn disabled" data-action="levelUp">
                  <div class="cost-display">
                    <span id="levelCost" class="cost-number">3000</span>
                    <span class="cost-currency">Sips</span>
                  </div>
                  <div class="btn-label">Level Up</div>
                </button>
              </div>
            </div>
          </div>

          <!-- Upgrades Sidebar -->
          <div class="upgrades-sidebar">
            <div class="sidebar-header">
              <h3 class="sidebar-title">Click Upgrades</h3>
              <p class="sidebar-subtitle">Enhance your clicking power</p>
            </div>

            <div class="upgrade-cards">
              <div class="upgrade-card">
                <div class="upgrade-header">
                  <div class="upgrade-icon">üí®</div>
                  <div class="upgrade-info">
                    <h4 class="upgrade-name">Suction</h4>
                    <p class="upgrade-description">Increase click power</p>
                  </div>
                </div>
                <button class="upgrade-btn" data-action="buySuction">
                  <div class="upgrade-cost"><span id="suctionCostCompact">40</span> Sips</div>
                </button>
                <div class="upgrade-stats">
                  <div class="upgrade-effect">
                    +<span id="suctionClickBonusCompact">1.0</span> per click
                  </div>
                </div>
              </div>

              <div class="upgrade-card">
                <div class="upgrade-header">
                  <div class="upgrade-icon">‚ö°</div>
                  <div class="upgrade-info">
                    <h4 class="upgrade-name">Critical Click</h4>
                    <p class="upgrade-description">Chance for bonus clicks</p>
                  </div>
                </div>
                <button class="upgrade-btn" data-action="buyCriticalClick">
                  <div class="upgrade-cost"><span id="criticalClickCostCompact">60</span> Sips</div>
                </button>
                <div class="upgrade-stats">
                  <div class="upgrade-effect">
                    <span id="criticalClickChanceCompact">0.1</span>% chance
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Unlocks Tab -->
      <div id="unlocksTab" class="tab-content">
        <div class="unlocks-container">
          <div class="unlocks-header">
            <h2>üîì Feature Unlocks</h2>
            <p class="unlocks-subtitle">Discover new features as you progress!</p>
          </div>

          <div class="unlocks-grid" id="unlocksGrid">
            <!-- Unlock items will be populated by JavaScript -->
          </div>

          <div class="unlocks-progress">
            <div class="progress-info">
              <span class="progress-label">Progress:</span>
              <span class="progress-value" id="unlocksProgress">0/12</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="unlocksProgressFill"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Shop & Upgrades Tab -->
      <div id="shopTab" class="tab-content">
        <div class="game-main">
          <!-- Shop Overview Area -->
          <div class="primary-action-area">
            <div class="shop-overview">
              <div class="shop-header">
                <h2 class="shop-title">üõí Shop & Upgrades</h2>
                <p class="shop-subtitle">
                  Invest in permanent improvements to boost your soda empire
                </p>
              </div>

              <div class="production-summary">
                <div class="production-card">
                  <div class="production-header">
                    <div class="production-icon">üìä</div>
                    <div class="production-info">
                      <h3>Total Production</h3>
                      <p>Your passive income per drink</p>
                    </div>
                  </div>
                  <div class="production-stats">
                    <div class="production-stat">
                      <span class="production-label">Straws</span>
                      <span class="production-value" id="totalStrawProduction">0</span>
                    </div>
                    <div class="production-stat">
                      <span class="production-label">Cups</span>
                      <span class="production-value" id="totalCupProduction">0</span>
                    </div>
                    <div class="production-stat total">
                      <span class="production-label">Total/Drink</span>
                      <span class="production-value" id="totalPassiveProduction">0</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Production Buildings Sidebar -->
          <div class="upgrades-sidebar">
            <div class="sidebar-header">
              <h3 class="sidebar-title">Production Buildings</h3>
              <p class="sidebar-subtitle">Generate sips automatically</p>
            </div>

            <div class="upgrade-cards">
              <!-- Straw Production -->
              <div class="production-group">
                <div class="production-group-header">
                  <div class="production-group-icon">ü•§</div>
                  <div class="production-group-info">
                    <h4>Straw Production</h4>
                    <p class="text-muted">Base production building</p>
                  </div>
                </div>

                <div class="upgrade-card">
                  <div class="upgrade-header">
                    <div class="upgrade-icon">ü•§</div>
                    <div class="upgrade-info">
                      <h4 class="upgrade-name">Extra Straw</h4>
                      <p class="upgrade-description">Generate sips per drink</p>
                    </div>
                  </div>
                  <button class="upgrade-btn" data-action="buyStraw">
                    <div class="upgrade-cost"><span id="strawCost">5</span> Sips</div>
                  </button>
                  <div class="upgrade-stats">
                    <div class="upgrade-owned">Owned: <span id="straws">0</span></div>
                    <div class="upgrade-effect">+<span id="strawSPD">0</span> per drink</div>
                  </div>
                </div>

                <div class="upgrade-card enhancement">
                  <div class="upgrade-header">
                    <div class="upgrade-icon">üîß</div>
                    <div class="upgrade-info">
                      <h4 class="upgrade-name">Wider Straws</h4>
                      <p class="upgrade-description">Enhance straw efficiency</p>
                    </div>
                  </div>
                  <button class="upgrade-btn" data-action="buyWiderStraws">
                    <div class="upgrade-cost"><span id="widerStrawsCost">150</span> Sips</div>
                  </button>
                  <div class="upgrade-stats">
                    <div class="upgrade-owned">Owned: <span id="widerStraws">0</span></div>
                    <div class="upgrade-effect">+<span id="widerStrawsSPD">0</span>% boost</div>
                  </div>
                </div>
              </div>

              <!-- Cup Production -->
              <div class="production-group">
                <div class="production-group-header">
                  <div class="production-group-icon">‚òï</div>
                  <div class="production-group-info">
                    <h4>Cup Production</h4>
                    <p class="text-muted">Advanced production building</p>
                  </div>
                </div>

                <div class="upgrade-card">
                  <div class="upgrade-header">
                    <div class="upgrade-icon">‚òï</div>
                    <div class="upgrade-info">
                      <h4 class="upgrade-name">Bigger Cup</h4>
                      <p class="upgrade-description">Higher capacity production</p>
                    </div>
                  </div>
                  <button class="upgrade-btn" data-action="buyCup">
                    <div class="upgrade-cost"><span id="cupCost">15</span> Sips</div>
                  </button>
                  <div class="upgrade-stats">
                    <div class="upgrade-owned">Owned: <span id="cups">0</span></div>
                    <div class="upgrade-effect">+<span id="cupSPD">0</span> per drink</div>
                  </div>
                </div>

                <div class="upgrade-card enhancement">
                  <div class="upgrade-header">
                    <div class="upgrade-icon">üîß</div>
                    <div class="upgrade-info">
                      <h4 class="upgrade-name">Better Cups</h4>
                      <p class="upgrade-description">Enhance cup efficiency</p>
                    </div>
                  </div>
                  <button class="upgrade-btn" data-action="buyBetterCups">
                    <div class="upgrade-cost"><span id="betterCupsCost">400</span> Sips</div>
                  </button>
                  <div class="upgrade-stats">
                    <div class="upgrade-owned">Owned: <span id="betterCups">0</span></div>
                    <div class="upgrade-effect">+<span id="betterCupsSPD">0</span>% boost</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Options Tab -->
      <div id="optionsTab" class="tab-content">
        <div class="options-container">
          <div class="options-section">
            <h3>üîä Button Audio</h3>
            <div class="sound-controls">
              <button
                id="buttonSoundsToggle"
                data-action="toggleButtonSounds"
                class="sound-toggle-btn"
              >
                üîä Button Sounds ON
              </button>
              <p class="sound-description">Enable or disable button click sound effects</p>
            </div>
          </div>

          <div class="options-section">
            <h3>üíæ Save & Load</h3>
            <div class="save-controls">
              <button data-action="save" class="save-btn">Save Game</button>
              <button data-action="delete_save" class="save-btn">Delete Save</button>
              <button data-action="devExportSave" class="save-btn">Export Save</button>
              <button data-action="devImportSave" class="save-btn">Import Save</button>
            </div>
          </div>

          <div class="options-section">
            <h3>‚è∞ Auto-Save Settings</h3>
            <div class="autosave-controls">
              <label class="autosave-toggle">
                <input type="checkbox" id="autosaveToggle" data-action="toggleAutosave" />
                <span class="toggle-slider"></span>
                Enable Auto-Save
              </label>
              <div class="autosave-interval">
                <label for="autosaveInterval">Auto-Save Interval:</label>
                <select id="autosaveInterval" data-action="changeAutosaveInterval">
                  <option value="5">5 seconds</option>
                  <option value="10" selected>10 seconds</option>
                  <option value="15">15 seconds</option>
                  <option value="30">30 seconds</option>
                  <option value="60">1 minute</option>
                  <option value="300">5 minutes</option>
                </select>
              </div>
              <div class="autosave-status">
                <span id="autosaveStatus">Auto-save enabled (10s)</span>
              </div>
            </div>
          </div>

          <div class="options-section">
            <h3>üéÆ Game Information</h3>
            <div class="game-info">
              <div class="info-item">
                <span class="info-label">Version:</span>
                <span class="info-value">1.0.0</span>
              </div>
              <div class="info-item">
                <span class="info-label">Last Save:</span>
                <span class="info-value" id="lastSaveTime">Never</span>
              </div>
              <div class="info-item">
                <span class="info-label">Play Time:</span>
                <span class="info-value" id="playTime">0:00:00</span>
              </div>
            </div>
          </div>

          <!-- Mobile-only: God Section -->
          <div class="options-section mobile-only">
            <h3>üôè Talk to God</h3>
            <div class="god-section-mobile">
              <div class="god-header-mobile">
                <h4>Seek Divine Guidance</h4>
                <p>Ask the almighty for wisdom and blessings in your soda journey.</p>
              </div>
              <div class="god-content-mobile">
                <div class="god-message-mobile" id="godMessageMobile">
                  "Welcome, mortal. I see you seek the path of the soda drinker. What wisdom do you
                  require?"
                </div>
                <div class="god-actions-mobile">
                  <button class="god-btn-mobile" data-action="godBlessing">Request Blessing</button>
                  <button class="god-btn-mobile" data-action="godWisdom">Seek Wisdom</button>
                  <button class="god-btn-mobile" data-action="godPraise">Praise the Divine</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Mobile-only: Dev Tools Section -->
          <div class="options-section mobile-only">
            <h3>üîß Development Tools</h3>
            <div class="dev-section-mobile">
              <div class="dev-warning-mobile">
                <p>‚ö†Ô∏è Development tools are for testing purposes only. Use with caution!</p>
              </div>
              <div class="dev-actions-mobile">
                <button class="dev-btn-mobile" data-action="devAddSips">Add Sips</button>
                <button class="dev-btn-mobile" data-action="devAddTime">Add Time</button>
                <button class="dev-btn-mobile" data-action="devUnlockAll">Unlock All</button>
                <button class="dev-btn-mobile" data-action="devResetUnlocks">Reset Unlocks</button>
                <button class="dev-btn-mobile" data-action="devClearConsole">Clear Console</button>
                <button class="dev-btn-mobile" data-action="devPerformanceTest">
                  Performance Test
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Stats Tab -->
      <div id="statsTab" class="tab-content">
        <div class="stats-container">
          <div class="stats-section">
            <h3>‚è±Ô∏è Time & Progress</h3>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-icon">‚è∞</div>
                <div class="stat-content">
                  <div class="stat-label">Total Play Time</div>
                  <div class="stat-value" id="totalPlayTime">0:00:00</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">üéØ</div>
                <div class="stat-content">
                  <div class="stat-label">Current Session</div>
                  <div class="stat-value" id="sessionTime">0:00:00</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">üìÖ</div>
                <div class="stat-content">
                  <div class="stat-label">Days Since Start</div>
                  <div class="stat-value" id="daysSinceStart">0</div>
                </div>
              </div>
            </div>
          </div>

          <div class="stats-section">
            <h3>üñ±Ô∏è Clicking Statistics</h3>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-icon">üëÜ</div>
                <div class="stat-content">
                  <div class="stat-label">Total Clicks</div>
                  <div class="stat-value" id="totalClicks">0</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">‚ö°</div>
                <div class="stat-content">
                  <div class="stat-label">Clicks Per Second</div>
                  <div class="stat-value" id="clicksPerSecond">0.00</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">üèÜ</div>
                <div class="stat-content">
                  <div class="stat-label">Best Click Streak</div>
                  <div class="stat-value" id="bestClickStreak">0</div>
                </div>
              </div>
            </div>
          </div>

          <div class="stats-section">
            <h3>üí∞ Economy & Progress</h3>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-icon">üíß</div>
                <div class="stat-content">
                  <div class="stat-label">Total Sips Earned</div>
                  <div class="stat-value" id="totalSipsEarned">0</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">üìà</div>
                <div class="stat-content">
                  <div class="stat-label">Current Sips/Second</div>
                  <div class="stat-value" id="currentSipsPerSecond">0.00</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">üöÄ</div>
                <div class="stat-content">
                  <div class="stat-label">Highest Sips/Second</div>
                  <div class="stat-value" id="highestSipsPerSecond">0.00</div>
                </div>
              </div>
            </div>
          </div>

          <div class="stats-section">
            <h3>üõí Shop & Upgrades</h3>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-icon">ü•§</div>
                <div class="stat-content">
                  <div class="stat-label">Straws Purchased</div>
                  <div class="stat-value" id="strawsPurchased">0</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">‚òï</div>
                <div class="stat-content">
                  <div class="stat-label">Cups Purchased</div>
                  <div class="stat-value" id="cupsPurchased">0</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">ü•§</div>
                <div class="stat-content">
                  <div class="stat-label">Wider Straw Upgrades</div>
                  <div class="stat-value" id="widerStrawsPurchased">0</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">‚òï</div>
                <div class="stat-content">
                  <div class="stat-label">Better Cup Upgrades</div>
                  <div class="stat-value" id="betterCupsPurchased">0</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">üí®</div>
                <div class="stat-content">
                  <div class="stat-label">Suctions Purchased</div>
                  <div class="stat-value" id="suctionsPurchased">0</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">üí•</div>
                <div class="stat-content">
                  <div class="stat-label">Critical Clicks</div>
                  <div class="stat-value" id="criticalClicksPurchased">0</div>
                </div>
              </div>
            </div>
          </div>

          <div class="stats-section">
            <h3>üéâ Achievements & Milestones</h3>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-icon">‚≠ê</div>
                <div class="stat-content">
                  <div class="stat-label">Current Level</div>
                  <div class="stat-value" id="currentLevel">1</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">üîß</div>
                <div class="stat-content">
                  <div class="stat-label">Total Upgrades</div>
                  <div class="stat-value" id="totalUpgrades">0</div>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon">üíé</div>
                <div class="stat-content">
                  <div class="stat-label">Faster Drinks Owned</div>
                  <div class="stat-value" id="fasterDrinksOwned">0</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- TempleOS God Tab -->
      <div id="godTab" class="tab-content">
        <div class="god-container">
          <div class="god-header">
            <h2>üôè Talk to God</h2>
            <p class="god-subtitle">Seek divine wisdom and guidance</p>
          </div>

          <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
              <div class="message god-message">
                <div class="message-avatar">
                  <img
                    src="images/TempleOS.jpg"
                    alt="God"
                    style="width: 100%; height: 100%; object-fit: cover; border-radius: 6px"
                  />
                </div>
                <div class="message-content">
                  <div class="message-sender">God</div>
                  <div class="message-text">
                    Greetings, mortal! I am listening to your prayers. What would you like to
                    discuss?
                  </div>
                </div>
              </div>
            </div>

            <div class="chat-input-container">
              <input
                type="text"
                id="chatInput"
                class="chat-input"
                placeholder="Type your message to God..."
                maxlength="100"
              />
              <button data-action="sendChat" class="chat-send-btn">üôè Send</button>
            </div>
          </div>

          <div class="god-info">
            <p>
              üí° <strong>Tip:</strong> God responds with divine wisdom and guidance. Type anything
              to receive spiritual insight!
            </p>
            <p style="margin-top: 1rem; font-size: 0.9em; color: #ff8e53; font-style: italic">
              <strong>Divine Inspiration:</strong> This sacred oracle draws wisdom from ancient
              sacred texts, providing guidance through carefully selected words of divine origin.<br />
              <em
                >The divine word generator uses mystical wisdom to offer meaningful insights and
                inspiration for your journey.</em
              >
            </p>
            <p style="margin-top: 0.5rem; font-size: 0.8em; color: #888; font-style: italic">
              <em>‚ö° If you know, you know... this oracle runs on 64-bit divine wisdom ‚ú®</em>
            </p>
          </div>
        </div>
      </div>

      <!-- Dev Tools Tab -->
      <div id="devTab" class="tab-content">
        <div class="dev-container">
          <div class="dev-header">
            <h2>üîß Development Tools</h2>
            <p class="dev-subtitle">Testing and development utilities</p>
            <div class="dev-status" id="devStatus">
              <span class="dev-status-label">Dev Mode:</span>
              <span class="dev-status-value" id="devModeStatus">Disabled</span>
            </div>
          </div>

          <div class="dev-section">
            <h3>üöÄ Feature Unlocks</h3>
            <div class="dev-grid">
              <button data-action="devUnlockAll" class="dev-btn unlock-all">
                <div class="dev-btn-icon">üîì</div>
                <div class="dev-btn-text">Unlock All Features</div>
              </button>
              <button data-action="devUnlockShop" class="dev-btn unlock-shop">
                <div class="dev-btn-icon">üõí</div>
                <div class="dev-btn-text">Unlock Shop</div>
              </button>
              <button data-action="devUnlockUpgrades" class="dev-btn unlock-upgrades">
                <div class="dev-btn-icon">‚ö°</div>
                <div class="dev-btn-text">Unlock All Upgrades</div>
              </button>
              <button data-action="devResetUnlocks" class="dev-btn reset">
                <div class="dev-btn-icon">üîÑ</div>
                <div class="dev-btn-text">Reset Unlocks</div>
              </button>
            </div>
          </div>

          <div class="dev-section">
            <h3>‚è∞ Time Travel</h3>
            <div class="dev-grid">
              <button data-action="devAddTime:3600000" class="dev-btn time-travel">
                <div class="dev-btn-icon">‚è∞</div>
                <div class="dev-btn-text">+1 Hour</div>
              </button>
              <button data-action="devAddTime:86400000" class="dev-btn time-travel">
                <div class="dev-btn-icon">üìÖ</div>
                <div class="dev-btn-text">+1 Day</div>
              </button>
              <button data-action="devAddTime:604800000" class="dev-btn time-travel">
                <div class="dev-btn-icon">üìÜ</div>
                <div class="dev-btn-text">+1 Week</div>
              </button>
              <button data-action="devAddTime:2592000000" class="dev-btn time-travel">
                <div class="dev-btn-icon">üóìÔ∏è</div>
                <div class="dev-btn-text">+1 Month</div>
              </button>
            </div>
          </div>

          <div class="dev-section">
            <h3>üí∞ Resource Management</h3>
            <div class="dev-grid">
              <button data-action="devAddSips:1000" class="dev-btn resources">
                <div class="dev-btn-icon">ü•§</div>
                <div class="dev-btn-text">+1000 Sips</div>
              </button>
              <button data-action="devAddSips:10000" class="dev-btn resources">
                <div class="dev-btn-icon">ü•§</div>
                <div class="dev-btn-text">+10K Sips</div>
              </button>
              <button data-action="devAddSips:100000" class="dev-btn resources">
                <div class="dev-btn-icon">ü•§</div>
                <div class="dev-btn-text">+100K Sips</div>
              </button>
              <button data-action="devAddSips:1000000" class="dev-btn resources">
                <div class="dev-btn-icon">ü•§</div>
                <div class="dev-btn-text">+1M Sips</div>
              </button>
            </div>
          </div>

          <div class="dev-section">
            <h3>üêõ Debug Tools</h3>
            <div class="dev-grid">
              <button data-action="devClearConsole" class="dev-btn debug-tools">
                <div class="dev-btn-icon">üßπ</div>
                <div class="dev-btn-text">Clear Console</div>
              </button>
              <button data-action="devExportState" class="dev-btn debug-tools">
                <div class="dev-btn-icon">üíæ</div>
                <div class="dev-btn-text">Export State</div>
              </button>
              <button data-action="devPerformanceTest" class="dev-btn debug-tools">
                <div class="dev-btn-icon">‚ö°</div>
                <div class="dev-btn-text">Performance Test</div>
              </button>
            </div>
            <div class="dev-info">
              <p>
                üêõ <strong>Debug Tools:</strong> Essential debugging utilities for development and
                testing.
              </p>
            </div>
          </div>

          <div class="dev-section">
            <h3>üåå Large Number Tests</h3>
            <div class="dev-grid">
              <button
                data-action="largeNumberTest:addExtremeResources"
                class="dev-btn large-number-test"
              >
                <div class="dev-btn-icon">üåü</div>
                <div class="dev-btn-text">Add Extreme Resources</div>
              </button>
              <button
                data-action="largeNumberTest:resetAllResources"
                class="dev-btn large-number-test reset"
              >
                <div class="dev-btn-icon">üîÑ</div>
                <div class="dev-btn-text">Reset All Resources</div>
              </button>
            </div>
            <div class="dev-info">
              <p>
                üåå <strong>Large Number Tests:</strong> Test extreme value handling with
                break_eternity.js.
              </p>
            </div>
          </div>

          <div class="dev-info">
            <p>
              ‚ö†Ô∏è <strong>Warning:</strong> These tools are for development and testing purposes
              only!
            </p>
            <p>
              üí° <strong>Tip:</strong> Use these tools to test game balance, debug issues, or
              experiment with different game states.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Single entry: ts/index.ts will import all other modules -->
    <script type="module" src="ts/index.ts"></script>
    <script>
      // Ensure Decimal is available globally before loading main.js
      if (typeof Decimal === 'undefined') {
        console.error('‚ùå Decimal library not loaded! Game will not work properly.');
      } else {
        console.log('‚úÖ Decimal library loaded successfully');
      }

      // Let main.js handle the script loading since the modular files are now working
      console.log('üîß Core scripts loaded, main.js will handle the rest...');
    </script>
  </body>
</html>
